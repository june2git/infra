# ğŸ”„ CI/CD êµ¬ì¡° ì„¤ëª…

## ğŸ“¦ ì €ì¥ì†Œë³„ ì—­í• 

### 1. `eks-app` - ì• í”Œë¦¬ì¼€ì´ì…˜ ì†ŒìŠ¤ ì½”ë“œ

**ì—­í• **: 3ê°œ ì• í”Œë¦¬ì¼€ì´ì…˜ ì†ŒìŠ¤ ì½”ë“œ + CI íŠ¸ë¦¬ê±°

**í¬í•¨ ì• í”Œë¦¬ì¼€ì´ì…˜**:
- `demo/` - Spring Boot (Gradle)
- `go/kafka-producer/` - Go ì• í”Œë¦¬ì¼€ì´ì…˜
- `go/kafka-consumer/` - Go ì• í”Œë¦¬ì¼€ì´ì…˜

**CI/CD ì›Œí¬í”Œë¡œìš°**: âœ… í•„ìš”
- íŒŒì¼: `.github/workflows/ci.yaml`
- ì‘ì—…:
  1. **detect-changes**: ë³€ê²½ëœ íŒŒì¼ ê°ì§€ (paths-filter)
  2. **build-{app}**: ë³€ê²½ëœ ì•±ë§Œ Reusable Workflow í˜¸ì¶œ
  - secrets ì „ë‹¬ (GITOPS_PAT)
  - inputs ì „ë‹¬ (app_name, build_system, ecr_repo, gitops_repo ë“±)

**ì‹¤ì œ ë¹Œë“œ/ë°°í¬ ì‘ì—…ì€ devops-templatesì˜ Reusable Workflowì—ì„œ ìˆ˜í–‰ë¨**

---

### 2. `gitops` - ArgoCD ë°°í¬ ì„¤ì •

**ì—­í• **: Kubernetes ë¦¬ì†ŒìŠ¤ ì„ ì–¸ (ArgoCDê°€ ì½ìŒ)

**CI/CD ì›Œí¬í”Œë¡œìš°**: âŒ ë¶ˆí•„ìš”
- ì´ ì €ì¥ì†ŒëŠ” "ì„¤ì • íŒŒì¼"ë§Œ ì €ì¥
- ì‹¤ì œ ë¹Œë“œë‚˜ ë°°í¬ëŠ” í•˜ì§€ ì•ŠìŒ
- ArgoCDê°€ Git ë³€ê²½ì„ ê°ì§€í•˜ì—¬ ìë™ìœ¼ë¡œ ë°°í¬

---

### 3. `devops-templates` - Reusable Workflow

**ì—­í• **: ê³µí†µ CI/CD í…œí”Œë¦¿ (ì—¬ëŸ¬ ì•±ì—ì„œ ì¬ì‚¬ìš©)

**CI/CD ì›Œí¬í”Œë¡œìš°**: âœ… í•µì‹¬
- íŒŒì¼: `.github/workflows/build_and_push_template.yaml`
- ì‹¤ì œ ë¹Œë“œ/ë°°í¬ ì‘ì—…ì„ ëª¨ë‘ ìˆ˜í–‰:
  - ì½”ë“œ ë¹Œë“œ (Gradle/Maven/Node/Go)
  - Docker ì´ë¯¸ì§€ ë¹Œë“œ
  - ECRì— ì´ë¯¸ì§€ í‘¸ì‹œ
  - **GitOps ì €ì¥ì†Œ ìë™ ì—…ë°ì´íŠ¸** (yq ì‚¬ìš©)

---

## ğŸ”„ ì „ì²´ íë¦„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. eks-app ì €ì¥ì†Œ (ì½”ë“œ ë³€ê²½)                        â”‚
â”‚    - demo/ ë˜ëŠ” go/ í´ë” ì½”ë“œ ë³€ê²½                   â”‚
â”‚    - GitHub Actions íŠ¸ë¦¬ê±°                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. detect-changes Job (ìŠ¤ë§ˆíŠ¸ ë¹Œë“œ)                  â”‚
â”‚    - ë³€ê²½ëœ íŒŒì¼ ê°ì§€ (paths-filter)                â”‚
â”‚    - demo/producer/consumer ì¤‘ ë³€ê²½ëœ ì•±ë§Œ ë¹Œë“œ      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. eks-appì˜ ci.yaml                               â”‚
â”‚    - Reusable Workflow í˜¸ì¶œ                          â”‚
â”‚    - secrets ì „ë‹¬ (GITOPS_PAT)                       â”‚
â”‚    - inputs ì „ë‹¬ (app_name, ecr_repo, gitops_repo) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. Reusable Workflow (devops-templates)              â”‚
â”‚    - eks-app ì½”ë“œ checkout                           â”‚
â”‚    - gitops ì €ì¥ì†Œ checkout (PAT ì‚¬ìš©)              â”‚
â”‚    - Gradle/Go ë¹Œë“œ                                   â”‚
â”‚    - Docker ì´ë¯¸ì§€ ë¹Œë“œ                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. ECRì— í‘¸ì‹œ                                         â”‚
â”‚    - ì´ë¯¸ì§€: demo-app:demo-main-57 (ë²„ì „ íƒœê·¸)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 6. GitOps ì €ì¥ì†Œ ìë™ ì—…ë°ì´íŠ¸ (yq ì‚¬ìš©)            â”‚
â”‚    - values-prod.yaml ë˜ëŠ” kafka-apps-values.yaml   â”‚
â”‚    - image.repository ì—…ë°ì´íŠ¸                       â”‚
â”‚    - image.tag = "demo-main-57" (ìƒˆ ë²„ì „)           â”‚
â”‚    - ìë™ ì»¤ë°‹ & í‘¸ì‹œ (retry ë¡œì§ í¬í•¨)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 7. ArgoCD ìë™ ê°ì§€ ë° ë°°í¬                           â”‚
â”‚    - GitOps Git ë³€ê²½ ê°ì§€                             â”‚
â”‚    - Kubernetes ë¦¬ì†ŒìŠ¤ ë™ê¸°í™”                        â”‚
â”‚    - Pod ì¬ë°°í¬ (ìƒˆ ì´ë¯¸ì§€ íƒœê·¸)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 8. Kubernetes (EKS)                                  â”‚
â”‚    - Pod: ìƒˆ ì´ë¯¸ì§€ íƒœê·¸ë¡œ ì¬ë°°í¬                    â”‚
â”‚    - Service, Ingress ìœ ì§€                           â”‚
â”‚    - demo.june2soul.store ì ‘ê·¼ ê°€ëŠ¥                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## â“ ì™œ GitOpsì— CI/CDê°€ ë¶ˆí•„ìš”í•œê°€?

### **GitOps ì›ì¹™**

GitOpsëŠ” Gitì„ "ë‹¨ì¼ ì†ŒìŠ¤"ë¡œ ì‚¬ìš©í•©ë‹ˆë‹¤.

```bash
# âœ… ì˜¬ë°”ë¥¸ êµ¬ì¡°
eks-app ì €ì¥ì†Œ
  â”œâ”€â”€ demo/               # Spring Boot ì†ŒìŠ¤ ì½”ë“œ
  â”œâ”€â”€ go/                 # Go ì†ŒìŠ¤ ì½”ë“œ
  â”‚   â”œâ”€â”€ kafka-producer/
  â”‚   â””â”€â”€ kafka-consumer/
  â””â”€â”€ .github/workflows/  # CI/CD íŒŒì´í”„ë¼ì¸

gitops ì €ì¥ì†Œ
  â”œâ”€â”€ apps/               # ArgoCD Application ì •ì˜
  â”‚   â”œâ”€â”€ demo-app.yaml
  â”‚   â””â”€â”€ kafka-apps.yaml
  â””â”€â”€ charts/             # Kubernetes ì„¤ì • (ë°°í¬ë§Œ)
      â”œâ”€â”€ templates/      # K8s ë¦¬ì†ŒìŠ¤ í…œí”Œë¦¿
      â”œâ”€â”€ values-prod.yaml        # demo ì´ë¯¸ì§€ íƒœê·¸ (ìë™ ì—…ë°ì´íŠ¸)
      â””â”€â”€ kafka-apps-values.yaml  # kafka ì´ë¯¸ì§€ íƒœê·¸ (ìë™ ì—…ë°ì´íŠ¸)
```

GitOps ì €ì¥ì†ŒëŠ”:
- **ì„¤ì • íŒŒì¼**ë§Œ ì €ì¥
- ì½”ë“œ ë¹Œë“œë‚˜ ë°°í¬ ë¡œì§ì€ ì—†ìŒ
- ArgoCDê°€ ì½ì–´ì„œ ì‚¬ìš©

---

## ğŸ“ í˜„ì¬ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
project/
â”œâ”€â”€ infra/          # Terraform ì¸í”„ë¼ (EKS í´ëŸ¬ìŠ¤í„°)
â”œâ”€â”€ eks-app/              # âœ… CI íŠ¸ë¦¬ê±° (3ê°œ ì• í”Œë¦¬ì¼€ì´ì…˜)
â”‚   â”œâ”€â”€ demo/             # Spring Boot ì• í”Œë¦¬ì¼€ì´ì…˜ (Gradle)
â”‚   â”œâ”€â”€ go/
â”‚   â”‚   â”œâ”€â”€ kafka-producer/  # Go ì• í”Œë¦¬ì¼€ì´ì…˜
â”‚   â”‚   â””â”€â”€ kafka-consumer/  # Go ì• í”Œë¦¬ì¼€ì´ì…˜
â”‚   â””â”€â”€ .github/workflows/ci.yaml 
â”‚       - detect-changes: ë³€ê²½ ê°ì§€ (paths-filter)
â”‚       - build-demo/producer/consumer: Reusable Workflow í˜¸ì¶œ
â”œâ”€â”€ devops-templates/     # âœ… CI/CD í•µì‹¬ (Reusable Workflow)
â”‚   â””â”€â”€ .github/workflows/build_and_push_template.yaml
â”‚       - ë¹Œë“œ (Gradle/Maven/Node/Go ì§€ì›)
â”‚       - Docker ì´ë¯¸ì§€ ë¹Œë“œ & ECR í‘¸ì‹œ
â”‚       - GitOps ì €ì¥ì†Œ ìë™ ì—…ë°ì´íŠ¸ (yq ì‚¬ìš©)
â””â”€â”€ gitops/               # âŒ CI/CD ì—†ìŒ (ì„ ì–¸ë§Œ)
    â”œâ”€â”€ apps/
    â”‚   â”œâ”€â”€ demo-app.yaml        (ArgoCD Application - demo)
    â”‚   â””â”€â”€ kafka-apps.yaml      (ArgoCD Application - kafka)
    â””â”€â”€ charts/
        â”œâ”€â”€ templates/           (Deployment, Service, Ingress)
        â”œâ”€â”€ values-prod.yaml     (demo ì´ë¯¸ì§€ íƒœê·¸)
        â””â”€â”€ kafka-apps-values.yaml  (producer/consumer ì´ë¯¸ì§€ íƒœê·¸)
```

---

## ğŸ¯ ê²°ë¡ 

- âœ… `eks-app/.github/workflows/ci.yaml` - CI íŠ¸ë¦¬ê±° + ë³€ê²½ ê°ì§€
- âœ… `devops-templates/.github/workflows/...` - ì‹¤ì œ ë¹Œë“œ/ë°°í¬ ì‘ì—… ìˆ˜í–‰

**í•µì‹¬ ì •ë¦¬**:
- **eks-app**: 3ê°œ ì•±(demo, kafka-producer, kafka-consumer) ì €ì¥, CI íŠ¸ë¦¬ê±° ì—­í• 
  - paths-filterë¡œ ë³€ê²½ëœ ì•±ë§Œ ì„ íƒì  ë¹Œë“œ (ë¹„ìš© ì ˆê°)
- **devops-templates**: ì‹¤ì œ ë¹Œë“œ/ë°°í¬ + GitOps ìë™ ì—…ë°ì´íŠ¸
  - ë‹¤ì–‘í•œ ë¹Œë“œ ì‹œìŠ¤í…œ ì§€ì› (Gradle/Maven/Node/Go)
  - yqë¥¼ ì‚¬ìš©í•œ YAML ìë™ ì—…ë°ì´íŠ¸
- **gitops**: Kubernetes ì„ ì–¸ë§Œ ì €ì¥, ArgoCDê°€ ìë™ ë°°í¬
  - values-prod.yaml (demo)
  - kafka-apps-values.yaml (kafka-producer/consumer)

**GitOpsëŠ” "ì„ ì–¸ì  ë°°í¬ ì„¤ì •"ë§Œ ì €ì¥í•˜ëŠ” ì €ì¥ì†Œ**ì´ë¯€ë¡œ CI/CD ì›Œí¬í”Œë¡œìš°ê°€ í•„ìš” ì—†ìŠµë‹ˆë‹¤.

---

## ğŸ¯ ìŠ¤ë§ˆíŠ¸ ë¹Œë“œ (ë³€ê²½ ê°ì§€)

**ë¹„ìš© ìµœì í™”**: ë³€ê²½ëœ ì• í”Œë¦¬ì¼€ì´ì…˜ë§Œ ì„ íƒì ìœ¼ë¡œ ë¹Œë“œ

- `dorny/paths-filter` ì•¡ì…˜ ì‚¬ìš©
- ë³€ê²½ ê°ì§€ íŒ¨í„´:
  - `demo/**` â†’ demo ì•±ë§Œ ë¹Œë“œ
  - `go/kafka-producer/**` â†’ producer ì•±ë§Œ ë¹Œë“œ
  - `go/kafka-consumer/**` â†’ consumer ì•±ë§Œ ë¹Œë“œ
- ìˆ˜ë™ ì‹¤í–‰ ê°€ëŠ¥ (workflow_dispatch)
  - íŠ¹ì • ì•±ë§Œ ì„ íƒí•˜ì—¬ ë°°í¬ ê°€ëŠ¥

